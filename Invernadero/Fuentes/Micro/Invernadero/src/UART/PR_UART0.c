/*******************************************************************************************************************************//**
 *
 * @file		PR_UART0.c
 * @brief		Contiene las definiciones de las funciones del modulo
 * @date		23 nov. 2020
 * @author		Taurozzi, Nicolás
 *
 **********************************************************************************************************************************/

/***********************************************************************************************************************************
 *** INCLUDES
 **********************************************************************************************************************************/
#include "PR_UART0.h"

 /***********************************************************************************************************************************
 *** FUNCIONES GLOBALES AL MODULO
 **********************************************************************************************************************************/

/***********************************************************************************************************************************
 *** DEFINES PRIVADOS AL MODULO
 **********************************************************************************************************************************/

/***********************************************************************************************************************************
 *** MACROS PRIVADAS AL MODULO
 **********************************************************************************************************************************/

/***********************************************************************************************************************************
 *** TIPOS DE DATOS PRIVADOS AL MODULO
 **********************************************************************************************************************************/

/***********************************************************************************************************************************
 *** TABLAS PRIVADAS AL MODULO
 **********************************************************************************************************************************/

/***********************************************************************************************************************************
 *** VARIABLES GLOBALES PUBLICAS
 **********************************************************************************************************************************/

/***********************************************************************************************************************************
 *** VARIABLES GLOBALES PRIVADAS AL MODULO
 **********************************************************************************************************************************/

/***********************************************************************************************************************************
 *** PROTOTIPO DE FUNCIONES PRIVADAS AL MODULO
 **********************************************************************************************************************************/

 /***********************************************************************************************************************************
 *** FUNCIONES PRIVADAS AL MODULO
 **********************************************************************************************************************************/

/**
	\fn    	void InicializarUART0(void)
	\brief  Inicializa la UART0
 	\author Nicolás Taurozzi
 	\date   22/07/2020
	\return No hay retorno
*/
void InicializarUART0(void)
{
	UART0_init();
}

/**
	\fn    	int32_t UART0_pop_rx(void)
	\brief  Saca un dato del vector de recepcion
 	\author Nicolás Taurozzi
 	\date   23/11/2020
	\return int32_t ret: valor que saco del vector de recepcion
*/
int32_t UART0_pop_rx(void)
{
	if(UART0_rx_in == UART0_rx_out) {
		return -1;
	} else {
		int32_t ret = UART0_rx_buff[UART0_rx_out];

		UART0_rx_out++;

		if(UART0_rx_out == RX_BUFF_SIZE) {
			UART0_rx_out = 0;
		}

		return ret;
	}
}

/**
	\fn    	void UART0_push_tx(uint8_t dato)
	\brief  Guarda en el vector de transmision un dato
 	\author Nicolás Taurozzi
 	\date   23/11/2020
 	\param  [in] uint8_t dato: dato a guardar en el vector de transmision
	\return No hay retorno
*/
void UART0_push_tx(uint8_t dato)
{
	if(UART0_flag_tx) {
		UART0_tx_buff[UART0_tx_in] = dato;

		UART0_tx_in++;

		if(UART0_tx_in == TX_BUFF_SIZE) {
			UART0_tx_in = 0;
		}
	} else {
		UART0_write_tx_reg(dato);
		UART0_flag_tx = 1;
	}
}

/**
	\fn    	void UART0_transmitir(uint8_t* msg)
	\brief  Carga en el vector de transmision un string
 	\author Nicolás Taurozzi
 	\date   22/07/2020
 	\param  [in] uint8_t* msg: string a cargar en el vector de tx
	\return No hay retorno
*/
void UART0_transmitir(uint8_t* msg)
{
	uint32_t idx = 0;

	for( idx =0 ; idx<DATA_SIZE; idx++){
		UART0_push_tx(msg[idx]);
	}
}
